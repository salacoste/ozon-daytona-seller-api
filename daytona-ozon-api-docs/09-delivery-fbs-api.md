# Delivery-FBS API - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–æ–π –∏ –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏ FBS

Delivery-FBS API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ FBS (Fulfillment by Seller), –≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–æ–∫, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–æ–º, –ø–æ–ª—É—á–µ–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤.

## –û–±–∑–æ—Ä API

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–¥–æ–≤:** 18  
**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:** –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏, –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç, —à—Ç—Ä–∏—Ö–∫–æ–¥—ã, —ç—Ç–∏–∫–µ—Ç–∫–∏  
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏–∑ –°–ù–ì

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –î–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏–∑ –°–ù–ì –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –º–µ—Ç–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∞ –æ—Ç–≥—Ä—É–∑–∫–∏.

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ—Ç–≥—Ä—É–∑–∫–∏ FBS

```
–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏ ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ ‚Üí –û—Ç–≥—Ä—É–∑–∫–∞ ‚Üí –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
      (new)       ‚Üí   (formed)   ‚Üí      (confirmed)       ‚Üí (shipped) ‚Üí (completed)
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã –º–µ—Ç–æ–¥–æ–≤

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏ (6 –º–µ—Ç–æ–¥–æ–≤)
- –°–æ–∑–¥–∞–Ω–∏–µ, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞ –æ—Ç–≥—Ä—É–∑–æ–∫
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Å–ø–∏—Å–∫–æ–≤ –æ—Ç–≥—Ä—É–∑–æ–∫
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ –æ—Ç–≥—Ä—É–∑–∫–∏

### 2. –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç –∏ —à—Ç—Ä–∏—Ö–∫–æ–¥—ã (9 –º–µ—Ç–æ–¥–æ–≤) 
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–æ–≤
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤ –∏ —ç—Ç–∏–∫–µ—Ç–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### 3. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (3 –º–µ—Ç–æ–¥–∞)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –¶–∏—Ñ—Ä–æ–≤—ã–µ –∞–∫—Ç—ã
- –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏

## –ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `createCarriage()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/create`

–°–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–≤—É—é FBS –æ—Ç–≥—Ä—É–∑–∫—É, –≤ –∫–æ—Ç–æ—Ä—É—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º ¬´–ì–æ—Ç–æ–≤ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

```typescript
interface DeliveryFbsCarriageCreateRequest {
  delivery_method_id: number;      // ID –º–µ—Ç–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
  first_mile_from_time: string;    // –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø—Ä–∏—ë–º–∞ (HH:mm)
  first_mile_to_time: string;      // –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏—ë–º–∞ (HH:mm)
  comment?: string;                // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –æ—Ç–≥—Ä—É–∑–∫–µ
}
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
import { OzonSellerApiClient } from '@spacechemical/ozon-seller-api';

const client = new OzonSellerApiClient({
  apiKey: 'your-api-key',
  clientId: 'your-client-id'
});

// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –æ—Ç–≥—Ä—É–∑–∫—É
const carriage = await client.deliveryFbs.createCarriage({
  delivery_method_id: 123,
  first_mile_from_time: '09:00',
  first_mile_to_time: '18:00',
  comment: '–û—Ç–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ 15.12.2024'
});

if (carriage.result?.carriage_id) {
  console.log(`‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å ID: ${carriage.result.carriage_id}`);
  console.log(`–°—Ç–∞—Ç—É—Å: ${carriage.result.status}`); // "new"
  console.log(`–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π: ${carriage.result.postings_count}`);
} else {
  console.log('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É');
}
```

### 2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `approveCarriage()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/approve`

–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ—Ç–≥—Ä—É–∑–∫—É –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –µ—ë –≤ —Å—Ç–∞—Ç—É—Å ¬´–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞¬ª. –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É
const approvalResult = await client.deliveryFbs.approveCarriage({
  carriage_id: 12345
});

if (approvalResult.result) {
  console.log('‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞');
  
  // –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
  const documents = await client.deliveryFbs.createAct({
    carriage_id: 12345,
    posting_number: ['12345-0001-1', '12345-0002-1']
  });
  
  if (documents.result) {
    console.log(`üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã, ID –∞–∫—Ç–∞: ${documents.act_id}`);
  }
}
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ç–≥—Ä—É–∑–∫–µ

**–ú–µ—Ç–æ–¥:** `getCarriage()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/get`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—Ç–≥—Ä—É–∑–∫–µ.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ç–≥—Ä—É–∑–∫–µ
const carriageInfo = await client.deliveryFbs.getCarriage({
  carriage_id: 12345
});

if (carriageInfo.result) {
  const carriage = carriageInfo.result;
  console.log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≥—Ä—É–∑–∫–∏: ${carriage.status}`);
  console.log(`–°–æ–∑–¥–∞–Ω–∞: ${new Date(carriage.created_at!).toLocaleString()}`);
  console.log(`–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π: ${carriage.postings_count}`);
  console.log(`–ú–µ—Ç–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏: ${carriage.delivery_method?.name}`);
  console.log(`–í—Ä–µ–º—è –ø—Ä–∏—ë–º–∞: ${carriage.first_mile_from_time} - ${carriage.first_mile_to_time}`);
}
```

### 4. –°–ø–∏—Å–æ–∫ –æ—Ç–≥—Ä—É–∑–æ–∫ –ø–æ –º–µ—Ç–æ–¥–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏

**–ú–µ—Ç–æ–¥:** `getCarriageDeliveryList()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/delivery/list`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ—Ç–≥—Ä—É–∑–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–≥—Ä—É–∑–æ–∫
const deliveryList = await client.deliveryFbs.getCarriageDeliveryList({
  status: 'new',  // –Ω–æ–≤—ã–µ –æ—Ç–≥—Ä—É–∑–∫–∏
  limit: 50
});

console.log('üìã –°–ø–∏—Å–æ–∫ –æ—Ç–≥—Ä—É–∑–æ–∫ –ø–æ –º–µ—Ç–æ–¥–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏:');
deliveryList.result?.forEach(item => {
  console.log(`\n–ú–µ—Ç–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏: ${item.delivery_method?.name} (ID: ${item.delivery_method?.id})`);
  
  if (item.carriages && item.carriages.length > 0) {
    item.carriages.forEach(carriage => {
      console.log(`  - –û—Ç–≥—Ä—É–∑–∫–∞ ${carriage.carriage_id}: ${carriage.status}`);
      console.log(`    –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π: ${carriage.postings_count}, —Å–æ–∑–¥–∞–Ω–∞: ${carriage.created_at}`);
    });
  } else {
    console.log('  –ù–µ—Ç –æ—Ç–≥—Ä—É–∑–æ–∫');
  }
});
```

### 5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `setPostings()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/set-postings`

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏–∑ –°–ù–ì.

–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –≤ –æ—Ç–≥—Ä—É–∑–∫–µ.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤ –æ—Ç–≥—Ä—É–∑–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –Ω–µ –∏–∑ –°–ù–ì)
try {
  const result = await client.deliveryFbs.setPostings({
    carriage_id: 12345,
    posting_number: ['12345-0001-1', '12345-0003-1', '12345-0005-1']
  });

  if (result.result) {
    console.log('‚úÖ –°–æ—Å—Ç–∞–≤ –æ—Ç–≥—Ä—É–∑–∫–∏ –∏–∑–º–µ–Ω—ë–Ω');
  }
} catch (error) {
  if (error.response?.status === 403) {
    console.log('‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏–∑ –°–ù–ì');
  }
}
```

### 6. –û—Ç–º–µ–Ω–∞ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `cancelCarriage()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v1/carriage/cancel`

–£–¥–∞–ª—è–µ—Ç –æ—Ç–≥—Ä—É–∑–∫—É. –í–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –û—Ç–º–µ–Ω–∏—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É
const cancelResult = await client.deliveryFbs.cancelCarriage({
  carriage_id: 12345
});

if (cancelResult.result) {
  console.log('‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞');
}
```

## –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∏ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞–º–∏

### 7. –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `createAct()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/create`

–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ—Ç–≥—Ä—É–∑–∫—É –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –Ω–∞–∫–ª–∞–¥–Ω–æ–π –∏ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–≥—Ä—É–∑–∫–∏
const actResult = await client.deliveryFbs.createAct({
  carriage_id: 12345,
  posting_number: ['12345-0001-1', '12345-0002-1', '12345-0003-1']
});

if (actResult.result) {
  console.log(`üìÑ –ê–∫—Ç —Å–æ–∑–¥–∞–Ω —Å ID: ${actResult.act_id}`);
  
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  const status = await client.deliveryFbs.checkActStatus({
    carriage_id: 12345
  });
  
  console.log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≥—Ä—É–∑–∫–∏: ${status.carriage_status}`);
  console.log(`–°—Ç–∞—Ç—É—Å —à—Ç—Ä–∏—Ö–∫–æ–¥–∞: ${status.barcode_status}`);
}
```

### 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ú–µ—Ç–æ–¥:** `checkActStatus()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/check-status`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —à—Ç—Ä–∏—Ö–∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Ç–≥—Ä—É–∑–∫–∏.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
const status = await client.deliveryFbs.checkActStatus({
  carriage_id: 12345
});

console.log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≥—Ä—É–∑–∫–∏: ${status.carriage_status}`);
console.log(`–°—Ç–∞—Ç—É—Å —à—Ç—Ä–∏—Ö–∫–æ–¥–∞: ${status.barcode_status}`);

if (status.documents && status.documents.length > 0) {
  console.log('–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:');
  status.documents.forEach(doc => {
    console.log(`  ${doc.type}: ${doc.status}`);
    if (doc.error_message) {
      console.log(`    –û—à–∏–±–∫–∞: ${doc.error_message}`);
    }
  });
}

// –ï—Å–ª–∏ –≤—Å–µ –≥–æ—Ç–æ–≤–æ - –ø–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
if (status.barcode_status === 'ready' && status.carriage_status === 'confirmed') {
  console.log('‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –∏ —à—Ç—Ä–∏—Ö–∫–æ–¥ –≥–æ—Ç–æ–≤—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
}
```

### 9. –ü–æ–ª—É—á–µ–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `getBarcode()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/get-barcode`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à—Ç—Ä–∏—Ö–∫–æ–¥ –≤ –≤–∏–¥–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (base64) –¥–ª—è –æ—Ç–≥—Ä—É–∑–∫–∏.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —à—Ç—Ä–∏—Ö–∫–æ–¥ –æ—Ç–≥—Ä—É–∑–∫–∏
const barcode = await client.deliveryFbs.getBarcode({
  carriage_id: 12345
});

if (barcode.barcode) {
  console.log(`üìä –ü–æ–ª—É—á–µ–Ω —à—Ç—Ä–∏—Ö–∫–æ–¥: ${barcode.content_type}`);
  
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞
  const fs = require('fs');
  const barcodeBuffer = Buffer.from(barcode.barcode, 'base64');
  fs.writeFileSync(`barcode-${12345}.png`, barcodeBuffer);
  
  console.log('‚úÖ –®—Ç—Ä–∏—Ö–∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ —Ñ–∞–π–ª');
}
```

### 10. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞

**–ú–µ—Ç–æ–¥:** `getBarcodeText()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/get-barcode/text`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à—Ç—Ä–∏—Ö–∫–æ–¥ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç —à—Ç—Ä–∏—Ö–∫–æ–¥–∞
const barcodeText = await client.deliveryFbs.getBarcodeText({
  carriage_id: 12345
});

if (barcodeText.barcode_text) {
  console.log(`üè∑Ô∏è –®—Ç—Ä–∏—Ö–∫–æ–¥: ${barcodeText.barcode_text}`);
  
  // –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–µ—á–∞—Ç–∏ –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  console.log('–ü–æ–∫–∞–∂–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –ø—É–Ω–∫—Ç–µ –≤—ã–¥–∞—á–∏:');
  console.log(`******************`);
  console.log(`* ${barcodeText.barcode_text} *`);
  console.log(`******************`);
}
```

### 11. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Ç–≥—Ä—É–∑–∫–∏

**–ú–µ—Ç–æ–¥:** `getAct()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/get-pdf`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç PDF —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –æ—Ç–≥—Ä—É–∑–∫–∏ (–ª–∏—Å—Ç –æ—Ç–≥—Ä—É–∑–∫–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è).

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –æ—Ç–≥—Ä—É–∑–∫–∏
const documents = await client.deliveryFbs.getAct({
  carriage_id: 12345,
  doc_type: 'act'  // –∏–ª–∏ 'transport_waybill'
});

if (documents.content) {
  console.log(`üìÑ –ü–æ–ª—É—á–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç: ${documents.filename}`);
  console.log(`–¢–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ: ${documents.content_type}`);
  
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PDF —Ñ–∞–π–ª
  const fs = require('fs');
  const docBuffer = Buffer.from(documents.content, 'base64');
  fs.writeFileSync(documents.filename!, docBuffer);
  
  console.log('‚úÖ –î–æ–∫—É–º–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ —Ñ–∞–π–ª');
}
```

### 12. –≠—Ç–∏–∫–µ—Ç–∫–∏ –¥–ª—è –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç

**–ú–µ—Ç–æ–¥:** `getContainerLabels()`  
**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /v2/posting/fbs/act/get-container-labels`

–°–æ–∑–¥–∞–µ—Ç —ç—Ç–∏–∫–µ—Ç–∫–∏ –¥–ª—è –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç –≤ –æ—Ç–≥—Ä—É–∑–∫–µ.

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —ç—Ç–∏–∫–µ—Ç–∫–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
const labels = await client.deliveryFbs.getContainerLabels({
  carriage_id: 12345,
  container_numbers: ['CONT001', 'CONT002', 'CONT003']
});

if (labels.content) {
  console.log(`üè∑Ô∏è –ü–æ–ª—É—á–µ–Ω—ã —ç—Ç–∏–∫–µ—Ç–∫–∏: ${labels.content_type}`);
  
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PDF —Å —ç—Ç–∏–∫–µ—Ç–∫–∞–º–∏
  const fs = require('fs');
  const labelsBuffer = Buffer.from(labels.content, 'base64');
  fs.writeFileSync(`labels-${12345}.pdf`, labelsBuffer);
  
  console.log('‚úÖ –≠—Ç–∏–∫–µ—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª');
}
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–≥—Ä—É–∑–∫–∏

```typescript
class FbsShipmentManager {
  constructor(private client: OzonSellerApiClient) {}

  async createCompleteShipment(deliveryMethodId: number, fromTime: string, toTime: string) {
    console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏...');
    
    try {
      // 1. –°–æ–∑–¥–∞–µ–º –æ—Ç–≥—Ä—É–∑–∫—É
      const carriage = await this.client.deliveryFbs.createCarriage({
        delivery_method_id: deliveryMethodId,
        first_mile_from_time: fromTime,
        first_mile_to_time: toTime,
        comment: `–û—Ç–≥—Ä—É–∑–∫–∞ –æ—Ç ${new Date().toLocaleDateString()}`
      });

      if (!carriage.result?.carriage_id) {
        throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É');
      }

      const carriageId = carriage.result.carriage_id;
      console.log(`‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ —Å–æ–∑–¥–∞–Ω–∞: ID ${carriageId}`);

      // 2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –æ—Ç–≥—Ä—É–∑–∫—É
      await this.client.deliveryFbs.approveCarriage({ carriage_id: carriageId });
      console.log('‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞');

      // 3. –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π
      const carriageInfo = await this.client.deliveryFbs.getCarriage({ 
        carriage_id: carriageId 
      });
      
      // 4. –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –∑–Ω–∞–µ–º –Ω–æ–º–µ—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
      const actResult = await this.client.deliveryFbs.createAct({
        carriage_id: carriageId,
        posting_number: [] // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
      });

      if (actResult.result) {
        console.log(`üìÑ –ê–∫—Ç —Å–æ–∑–¥–∞–Ω: ID ${actResult.act_id}`);
      }

      // 5. –ñ–¥–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
      await this.waitForDocuments(carriageId);

      // 6. –°–∫–∞—á–∏–≤–∞–µ–º –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
      await this.downloadAllDocuments(carriageId);

      console.log('üéâ –û—Ç–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞!');
      
      return {
        carriageId,
        actId: actResult.act_id,
        status: 'ready'
      };

    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏:', error);
      throw error;
    }
  }

  private async waitForDocuments(carriageId: number, maxAttempts: number = 10) {
    console.log('‚è≥ –û–∂–∏–¥–∞–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...');
    
    for (let attempt = 1; attempt <= maxAttempts; attempt++) {
      const status = await this.client.deliveryFbs.checkActStatus({
        carriage_id: carriageId
      });

      console.log(`–ü–æ–ø—ã—Ç–∫–∞ ${attempt}: –æ—Ç–≥—Ä—É–∑–∫–∞ ${status.carriage_status}, —à—Ç—Ä–∏—Ö–∫–æ–¥ ${status.barcode_status}`);

      if (status.carriage_status === 'confirmed' && status.barcode_status === 'ready') {
        console.log('‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã!');
        return;
      }

      if (status.carriage_status === 'error' || status.barcode_status === 'error') {
        throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤');
      }

      // –ñ–¥–µ–º 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π
      await new Promise(resolve => setTimeout(resolve, 30000));
    }

    throw new Error('–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤');
  }

  private async downloadAllDocuments(carriageId: number) {
    const fs = require('fs');
    const timestamp = Date.now();

    try {
      // –°–∫–∞—á–∏–≤–∞–µ–º —à—Ç—Ä–∏—Ö–∫–æ–¥
      const barcode = await this.client.deliveryFbs.getBarcode({
        carriage_id: carriageId
      });

      if (barcode.barcode) {
        const barcodeBuffer = Buffer.from(barcode.barcode, 'base64');
        fs.writeFileSync(`barcode-${carriageId}-${timestamp}.png`, barcodeBuffer);
        console.log('üìä –®—Ç—Ä–∏—Ö–∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
      }

      // –°–∫–∞—á–∏–≤–∞–µ–º –∞–∫—Ç
      const act = await this.client.deliveryFbs.getAct({
        carriage_id: carriageId,
        doc_type: 'act'
      });

      if (act.content) {
        const actBuffer = Buffer.from(act.content, 'base64');
        fs.writeFileSync(`act-${carriageId}-${timestamp}.pdf`, actBuffer);
        console.log('üìÑ –ê–∫—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
      }

      // –°–∫–∞—á–∏–≤–∞–µ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—É—é –Ω–∞–∫–ª–∞–¥–Ω—É—é
      const waybill = await this.client.deliveryFbs.getAct({
        carriage_id: carriageId,
        doc_type: 'transport_waybill'
      });

      if (waybill.content) {
        const waybillBuffer = Buffer.from(waybill.content, 'base64');
        fs.writeFileSync(`waybill-${carriageId}-${timestamp}.pdf`, waybillBuffer);
        console.log('üìã –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
      }

      console.log('‚úÖ –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å–∫–∞—á–∞–Ω—ã');

    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:', error);
    }
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const shipmentManager = new FbsShipmentManager(client);

const shipment = await shipmentManager.createCompleteShipment(
  123,      // ID –º–µ—Ç–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
  '09:00',  // –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø—Ä–∏—ë–º–∞
  '18:00'   // –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏—ë–º–∞
);

console.log(`–û—Ç–≥—Ä—É–∑–∫–∞ ${shipment.carriageId} –≥–æ—Ç–æ–≤–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ!`);
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∞–º–∏

```typescript
class ShipmentMonitor {
  constructor(private client: OzonSellerApiClient) {}

  // –ü–æ–ª—É—á–∏—Ç—å –æ–±–∑–æ—Ä –≤—Å–µ—Ö –æ—Ç–≥—Ä—É–∑–æ–∫
  async getShipmentsOverview() {
    const deliveryList = await this.client.deliveryFbs.getCarriageDeliveryList({
      limit: 100
    });

    const overview = {
      totalMethods: 0,
      totalCarriages: 0,
      statusCounts: new Map<string, number>(),
      deliveryMethods: [] as any[]
    };

    deliveryList.result?.forEach(method => {
      overview.totalMethods++;
      
      const methodInfo = {
        id: method.delivery_method?.id,
        name: method.delivery_method?.name,
        carriages: method.carriages || [],
        carriageCount: method.carriages?.length || 0
      };

      overview.deliveryMethods.push(methodInfo);
      overview.totalCarriages += methodInfo.carriageCount;

      // –ü–æ–¥—Å—á–µ—Ç –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
      method.carriages?.forEach(carriage => {
        const count = overview.statusCounts.get(carriage.status!) || 0;
        overview.statusCounts.set(carriage.status!, count + 1);
      });
    });

    return overview;
  }

  // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –æ—Ç–≥—Ä—É–∑–æ–∫
  async checkProblematicShipments() {
    const overview = await this.getShipmentsOverview();
    const issues: Array<{
      carriageId: number;
      issue: string;
      severity: 'low' | 'medium' | 'high';
      recommendation: string;
    }> = [];

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ new —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ
    for (const method of overview.deliveryMethods) {
      for (const carriage of method.carriages) {
        if (carriage.status === 'new') {
          const createdAt = new Date(carriage.created_at!);
          const hoursSinceCreation = (Date.now() - createdAt.getTime()) / (1000 * 60 * 60);
          
          if (hoursSinceCreation > 24) {
            issues.push({
              carriageId: carriage.carriage_id!,
              issue: `–û—Ç–≥—Ä—É–∑–∫–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ "new" –±–æ–ª–µ–µ ${Math.round(hoursSinceCreation)} —á–∞—Å–æ–≤`,
              severity: 'high',
              recommendation: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ—Ç–≥—Ä—É–∑–∫—É –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç–µ –µ—ë'
            });
          }
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö –æ—Ç–≥—Ä—É–∑–æ–∫
        if (carriage.status === 'formed' || carriage.status === 'confirmed') {
          try {
            const status = await this.client.deliveryFbs.checkActStatus({
              carriage_id: carriage.carriage_id!
            });

            if (status.barcode_status === 'error') {
              issues.push({
                carriageId: carriage.carriage_id!,
                issue: '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞',
                severity: 'high',
                recommendation: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–∞–≤ –æ—Ç–≥—Ä—É–∑–∫–∏ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã'
              });
            }

            if (status.documents?.some(doc => doc.status === 'error')) {
              issues.push({
                carriageId: carriage.carriage_id!,
                issue: '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                severity: 'high',
                recommendation: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã'
              });
            }
          } catch (error) {
            issues.push({
              carriageId: carriage.carriage_id!,
              issue: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
              severity: 'medium',
              recommendation: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ'
            });
          }
        }
      }
    }

    return issues;
  }

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º
  async autoFixIssues() {
    const issues = await this.checkProblematicShipments();
    const fixedIssues: number[] = [];
    const failedFixes: Array<{ carriageId: number; error: string }> = [];

    for (const issue of issues) {
      if (issue.severity === 'high' && issue.issue.includes('new')) {
        try {
          // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –æ—Ç–≥—Ä—É–∑–∫–∏
          await this.client.deliveryFbs.approveCarriage({
            carriage_id: issue.carriageId
          });
          
          fixedIssues.push(issue.carriageId);
          console.log(`‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –æ—Ç–≥—Ä—É–∑–∫–∞ ${issue.carriageId}`);
          
        } catch (error) {
          failedFixes.push({
            carriageId: issue.carriageId,
            error: error.message
          });
          console.log(`‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—Ç–≥—Ä—É–∑–∫—É ${issue.carriageId}: ${error.message}`);
        }
      }
    }

    return {
      totalIssues: issues.length,
      fixedCount: fixedIssues.length,
      fixedCarriages: fixedIssues,
      failedFixes
    };
  }

  // –û—Ç—á–µ—Ç –ø–æ –æ—Ç–≥—Ä—É–∑–∫–∞–º
  async generateShipmentReport(days: number = 7) {
    const cutoffDate = new Date();
    cutoffDate.setDate(cutoffDate.getDate() - days);

    const acts = await this.client.deliveryFbs.getActList({
      filter: {
        since: cutoffDate.toISOString(),
        to: new Date().toISOString()
      },
      limit: 1000
    });

    const report = {
      period: `${cutoffDate.toLocaleDateString()} - ${new Date().toLocaleDateString()}`,
      totalActs: acts.result?.length || 0,
      statusBreakdown: new Map<string, number>(),
      totalPostings: 0,
      averagePostingsPerAct: 0
    };

    acts.result?.forEach(act => {
      // –ü–æ–¥—Å—á–µ—Ç –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
      const count = report.statusBreakdown.get(act.status!) || 0;
      report.statusBreakdown.set(act.status!, count + 1);
      
      // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π
      report.totalPostings += act.postings_count || 0;
    });

    report.averagePostingsPerAct = report.totalActs > 0 ? 
      Math.round(report.totalPostings / report.totalActs * 100) / 100 : 0;

    return report;
  }
}

const monitor = new ShipmentMonitor(client);

// –ü–æ–ª—É—á–∏—Ç—å –æ–±–∑–æ—Ä –æ—Ç–≥—Ä—É–∑–æ–∫
const overview = await monitor.getShipmentsOverview();
console.log(`–í—Å–µ–≥–æ –º–µ—Ç–æ–¥–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏: ${overview.totalMethods}`);
console.log(`–í—Å–µ–≥–æ –æ—Ç–≥—Ä—É–∑–æ–∫: ${overview.totalCarriages}`);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
const issues = await monitor.checkProblematicShipments();
if (issues.length > 0) {
  console.log(`‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ ${issues.length} –ø—Ä–æ–±–ª–µ–º:`);
  issues.forEach(issue => {
    console.log(`${issue.severity.toUpperCase()}: –û—Ç–≥—Ä—É–∑–∫–∞ ${issue.carriageId} - ${issue.issue}`);
  });
}

// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
const report = await monitor.generateShipmentReport(7);
console.log(`üìä –û—Ç—á–µ—Ç –∑–∞ ${report.period}: ${report.totalActs} –∞–∫—Ç–æ–≤, ${report.totalPostings} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π`);
```

### 3. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≥—Ä—É–∑–æ–∫

```typescript
class BatchShipmentProcessor {
  constructor(private client: OzonSellerApiClient) {}

  // –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–æ–∫ –ø–æ –º–µ—Ç–æ–¥–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏
  async createMultipleShipments(
    shipmentRequests: Array<{
      deliveryMethodId: number;
      fromTime: string;
      toTime: string;
      comment?: string;
    }>
  ) {
    const results = [];
    const errors = [];

    for (const [index, request] of shipmentRequests.entries()) {
      try {
        console.log(`üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏ ${index + 1}/${shipmentRequests.length}...`);
        
        const carriage = await this.client.deliveryFbs.createCarriage({
          delivery_method_id: request.deliveryMethodId,
          first_mile_from_time: request.fromTime,
          first_mile_to_time: request.toTime,
          comment: request.comment
        });

        if (carriage.result?.carriage_id) {
          results.push({
            deliveryMethodId: request.deliveryMethodId,
            carriageId: carriage.result.carriage_id,
            status: carriage.result.status,
            postingsCount: carriage.result.postings_count
          });
          
          console.log(`‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ ${carriage.result.carriage_id} —Å–æ–∑–¥–∞–Ω–∞`);
        } else {
          errors.push({
            deliveryMethodId: request.deliveryMethodId,
            error: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –æ—Ç–≥—Ä—É–∑–∫–∏'
          });
        }

        // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
        if (index < shipmentRequests.length - 1) {
          await new Promise(resolve => setTimeout(resolve, 1000));
        }

      } catch (error) {
        errors.push({
          deliveryMethodId: request.deliveryMethodId,
          error: error.message
        });
        console.error(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏ –¥–ª—è –º–µ—Ç–æ–¥–∞ ${request.deliveryMethodId}: ${error.message}`);
      }
    }

    return { results, errors };
  }

  // –ú–∞—Å—Å–æ–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–æ–∫
  async approveMultipleCarriages(carriageIds: number[]) {
    const results = [];
    const errors = [];

    for (const carriageId of carriageIds) {
      try {
        await this.client.deliveryFbs.approveCarriage({
          carriage_id: carriageId
        });
        
        results.push(carriageId);
        console.log(`‚úÖ –û—Ç–≥—Ä—É–∑–∫–∞ ${carriageId} –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞`);
        
      } catch (error) {
        errors.push({
          carriageId,
          error: error.message
        });
        console.error(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏ ${carriageId}: ${error.message}`);
      }

      // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
      await new Promise(resolve => setTimeout(resolve, 500));
    }

    return { results, errors };
  }

  // –ú–∞—Å—Å–æ–≤–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  async downloadMultipleDocuments(
    carriageIds: number[],
    documentTypes: Array<'act' | 'transport_waybill'> = ['act', 'transport_waybill']
  ) {
    const fs = require('fs');
    const timestamp = Date.now();
    
    // –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    const folderName = `shipment-documents-${timestamp}`;
    if (!fs.existsSync(folderName)) {
      fs.mkdirSync(folderName);
    }

    const results = [];
    const errors = [];

    for (const carriageId of carriageIds) {
      try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        const status = await this.client.deliveryFbs.checkActStatus({
          carriage_id: carriageId
        });

        if (status.carriage_status !== 'confirmed' || status.barcode_status !== 'ready') {
          errors.push({
            carriageId,
            error: '–î–æ–∫—É–º–µ–Ω—Ç—ã –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤—ã'
          });
          continue;
        }

        const carriageFiles = [];

        // –°–∫–∞—á–∏–≤–∞–µ–º —à—Ç—Ä–∏—Ö–∫–æ–¥
        const barcode = await this.client.deliveryFbs.getBarcode({
          carriage_id: carriageId
        });

        if (barcode.barcode) {
          const barcodeBuffer = Buffer.from(barcode.barcode, 'base64');
          const barcodeFilename = `${folderName}/barcode-${carriageId}.png`;
          fs.writeFileSync(barcodeFilename, barcodeBuffer);
          carriageFiles.push(barcodeFilename);
        }

        // –°–∫–∞—á–∏–≤–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã
        for (const docType of documentTypes) {
          const document = await this.client.deliveryFbs.getAct({
            carriage_id: carriageId,
            doc_type: docType
          });

          if (document.content) {
            const docBuffer = Buffer.from(document.content, 'base64');
            const docFilename = `${folderName}/${docType}-${carriageId}.pdf`;
            fs.writeFileSync(docFilename, docBuffer);
            carriageFiles.push(docFilename);
          }
        }

        results.push({
          carriageId,
          files: carriageFiles
        });

        console.log(`‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–≥—Ä—É–∑–∫–∏ ${carriageId} —Å–∫–∞—á–∞–Ω—ã`);

      } catch (error) {
        errors.push({
          carriageId,
          error: error.message
        });
        console.error(`‚ùå –û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–≥—Ä—É–∑–∫–∏ ${carriageId}: ${error.message}`);
      }

      // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
      await new Promise(resolve => setTimeout(resolve, 2000));
    }

    console.log(`üìÅ –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫—É: ${folderName}`);
    return { results, errors, folder: folderName };
  }
}

const batchProcessor = new BatchShipmentProcessor(client);

// –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≥—Ä—É–∑–æ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
const shipmentRequests = [
  {
    deliveryMethodId: 123,
    fromTime: '09:00',
    toTime: '18:00',
    comment: '–û—Ç–≥—Ä—É–∑–∫–∞ –∫—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞'
  },
  {
    deliveryMethodId: 124,
    fromTime: '10:00',
    toTime: '17:00',
    comment: '–û—Ç–≥—Ä—É–∑–∫–∞ —Å–∞–º–æ–≤—ã–≤–æ–∑'
  }
];

const createResults = await batchProcessor.createMultipleShipments(shipmentRequests);
console.log(`–°–æ–∑–¥–∞–Ω–æ –æ—Ç–≥—Ä—É–∑–æ–∫: ${createResults.results.length}, –æ—à–∏–±–æ–∫: ${createResults.errors.length}`);

// –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ—Ç–≥—Ä—É–∑–∫–∏
if (createResults.results.length > 0) {
  const carriageIds = createResults.results.map(r => r.carriageId);
  const approveResults = await batchProcessor.approveMultipleCarriages(carriageIds);
  console.log(`–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ—Ç–≥—Ä—É–∑–æ–∫: ${approveResults.results.length}`);
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞

```typescript
try {
  const carriage = await client.deliveryFbs.createCarriage({
    delivery_method_id: 123,
    first_mile_from_time: '09:00',
    first_mile_to_time: '18:00'
  });
} catch (error) {
  if (error.response?.status === 400) {
    const errorData = error.response.data;
    
    switch (errorData.code) {
      case 'NO_POSTINGS_FOR_SHIPMENT':
        console.error('–ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≥–æ—Ç–æ–≤—ã—Ö –∫ –æ—Ç–≥—Ä—É–∑–∫–µ');
        break;
      case 'INVALID_DELIVERY_METHOD':
        console.error('–ù–µ–≤–µ—Ä–Ω—ã–π –º–µ—Ç–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏');
        break;
      case 'INVALID_TIME_RANGE':
        console.error('–ù–µ–≤–µ—Ä–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω');
        break;
      case 'CARRIAGE_ALREADY_EXISTS':
        console.error('–û—Ç–≥—Ä—É–∑–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
        break;
      default:
        console.error('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞:', errorData.message);
    }
  } else if (error.response?.status === 403) {
    console.error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞');
  } else if (error.response?.status === 429) {
    console.error('–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É –ø–æ–∑–∂–µ.');
  } else {
    console.error('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞:', error.message);
  }
}
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ—Ç–≥—Ä—É–∑–∫–∏

```typescript
// –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ü–∏–π
const checkCarriageStatus = async (carriageId: number) => {
  const carriage = await client.deliveryFbs.getCarriage({
    carriage_id: carriageId
  });
  
  return carriage.result?.status;
};

// –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–≥—Ä—É–∑–∫–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
const scheduleShipmentCreation = () => {
  // –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 10:00 —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–≥—Ä—É–∑–∫–∏
  const schedule = require('node-schedule');
  
  schedule.scheduleJob('0 10 * * *', async () => {
    console.log('üïô –ó–∞–ø—É—Å–∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≥—Ä—É–∑–æ–∫...');
    await batchProcessor.createMultipleShipments(dailyShipmentRequests);
  });
};
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥

```typescript
// –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –æ—Ç–≥—Ä—É–∑–æ–∫
const setupShipmentMonitoring = () => {
  setInterval(async () => {
    const issues = await monitor.checkProblematicShipments();
    
    if (issues.length > 0) {
      const criticalIssues = issues.filter(i => i.severity === 'high');
      if (criticalIssues.length > 0) {
        console.log(`üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´: ${criticalIssues.length}`);
        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
      }
    }
  }, 30 * 60 * 1000); // –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
};
```

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```typescript
// –ö—ç—à–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç—É—Å—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
class DocumentStatusCache {
  private cache = new Map<number, { status: any; timestamp: number }>();
  private readonly CACHE_TTL = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç

  async getStatus(client: OzonSellerApiClient, carriageId: number) {
    const cached = this.cache.get(carriageId);
    
    if (cached && Date.now() - cached.timestamp < this.CACHE_TTL) {
      return cached.status;
    }

    const status = await client.deliveryFbs.checkActStatus({
      carriage_id: carriageId
    });
    
    this.cache.set(carriageId, {
      status,
      timestamp: Date.now()
    });
    
    return status;
  }
}
```

---

**–°–≤—è–∑–∞–Ω–Ω—ã–µ API:** FBS API (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ FBS –∑–∞–∫–∞–∑–∞–º–∏), Delivery-RFBS API (–¥–æ—Å—Ç–∞–≤–∫–∞ rFBS), Warehouse API (—Å–∫–ª–∞–¥—ã)